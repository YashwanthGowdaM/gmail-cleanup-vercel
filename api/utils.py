<utils code omitted here for brevity in this demo>